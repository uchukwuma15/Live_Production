<?xml version="1.0" encoding="utf-8"?>
<!-- Copyright Nova Code (http://www.novacode.nl)
See LICENSE file for full licensing details. -->

<odoo>
    <template id="formio_form" name="Form.io Form">
        <t t-call="web.layout">
            <t t-set="head">
                <t t-call="formio.formio_html_head"/>
                <script type="text/javascript" src="/formio/static/src/js/odoo-formio-form.js"/>
            </t>

            <xpath expr="//t[@t-set='html_data']" position="after">
                <t t-set="body_classname" t-value="'o_connected_user' if env['ir.ui.view'].user_has_groups('base.group_user') else None"/>
            </xpath>

            <t t-call="formio.formio_menu_nav">
                <t t-set="items_menu_systray">
                    <!-- TODO: groups="formio.manager" ?? -->
                    <li t-if="form" id="edit-in-backend">
                        <a t-attf-href="#{form.act_window_url}"><span class="fa fa-cog"/> Form</a>
                    </li>
                </t>
            </t>

            <t t-call="formio.formio_header"/>

            <div id="wrapwrap">
                <main>
                    <div class="container mt16 mb16">
                        <div class="row actions">
                            <div class="col-md-6">
                                <t t-foreach="languages" t-as="lang">
                                    <button class="btn btn-sm btn-default" t-attf-onclick="setLanguage('{{ lang.iso_code }}')"><span t-field="lang.name"/></button>
                                </t>
                            </div>
                            <div class="col-md-6">
                                <div class="float-right pull-right">
                                    <a class="btn btn-sm btn-info"
                                       style="margin-left: 8px"
                                       t-attf-href="/my/formio">
                                        <span aria-label="My forms" title="My forms">My Forms</span>
                                    </a>
                                </div>
                                
                                <t t-if="form.allow_unlink">
                                    <div class="float-right pull-right">
                                        <a role="button" class="btn btn-sm btn-danger"
                                           style="margin-left: 8px"
                                           t-attf-href="/my/formio/delete/{{ form.uuid }}">
                                            <span aria-label="Delete form" title="Delete form">Delete Form</span>
                                        </a>
                                    </div>
                                </t>
                                <t t-elif="not form.allow_unlink and form.state in ['PENDING', 'DRAFT']">
                                    <div class="float-right pull-right">
                                        <a  role="button" class="btn btn-sm btn-warning"
                                            style="margin-left: 8px"
                                            t-attf-href="/my/formio/cancel/{{ form.uuid }}">
                                            <span aria-label="Cancel form" title="Cancel form">Cancel &amp; close Form</span>
                                        </a>
                                    </div>
                                </t>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mt16">
                                <h3 class="formio_form_name">
                                    <t t-esc="form.title"/>
                                </h3>
                            </div>
                            <div class="col-md-6 mt8">
                                <small class="float-right pull-right">
                                    <span class="text-muted">State: <span class="text-muted" t-field="form.state"/></span>
                                    <span class="text-muted"> | ID: <span t-field="form.id"/></span>

                                </small>
                            </div>
                        </div>
                        <div id="formio_form_container">
                            <div id="formio_form"></div>
                        </div>
                        <input type="hidden" id="form_uuid" name="uuid" t-att-value="form.uuid"/>
                    </div>
                </main>
            </div>
        </t>
    </template>
</odoo>
